name: Create Release

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Create Release
        uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: ${{ github.ref }}
          release_name: Release ${{ github.ref }}
          body: |
            ## ğŸ‰ LanShare ${{ github.ref }} å‘å¸ƒ
            
            ### ğŸ› ä¸»è¦ä¿®å¤
            - **Docker IPæ˜¾ç¤ºé—®é¢˜**: å®Œå…¨ä¿®å¤å®¹å™¨ä¸­çš„IPå’ŒäºŒç»´ç æ˜¾ç¤º
            - **ç½‘ç»œé…ç½®**: è§£å†³Dockerç¯å¢ƒä¸‹çš„ç½‘ç»œè¯†åˆ«é—®é¢˜
            
            ### ğŸš€ æ–°å¢åŠŸèƒ½
            - **ä¸€é”®éƒ¨ç½²**: æä¾›è‡ªåŠ¨IPæ£€æµ‹çš„å¯åŠ¨è„šæœ¬
            - **å¤šå¹³å°æ”¯æŒ**: Windowsã€Linuxã€macOSå¯åŠ¨è„šæœ¬
            - **ç®€åŒ–é…ç½®**: é¢„è®¾IPåœ°å€ï¼Œå¼€ç®±å³ç”¨
            
            ### ğŸ“¦ åŒ…å«å†…å®¹
            - å®Œæ•´çš„Dockeré…ç½®ï¼ˆ3ä¸ªç‰ˆæœ¬ï¼‰
            - ä¸€é”®å¯åŠ¨è„šæœ¬ï¼ˆWindows/Linux/macOSï¼‰
            - è¯¦ç»†çš„éƒ¨ç½²å’Œæ•…éšœæ’é™¤æ–‡æ¡£
            
            ### ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•
            ```bash
            # å¿«é€Ÿå¼€å§‹
docker-compose up -d

            # æˆ–ä½¿ç”¨ä¸€é”®è„šæœ¬
            ./start-with-ip.sh  # Linux/macOS
            .\start-with-ip.ps1  # Windows
            ```
            
            ### ğŸ“– æ–‡æ¡£
            - å®Œæ•´éƒ¨ç½²æŒ‡å—: [DEPLOYMENT.md](DEPLOYMENT.md)
            - å¿«é€Ÿå¼€å§‹: [QUICK-START.md](QUICK-START.md)
            
            ### ğŸ”— ä¸‹è½½
            - Dockeré•œåƒ: `zhong12138/lanshare:latest`
            - æºç : æœ¬Releaseé¡µé¢
            
            ---
            
            **ç¥å¤§å®¶ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
          draft: false
          prerelease: false

      - name: Upload Release Asset
        uses: actions/upload-release-asset@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          upload_url: ${{ steps.create_release.outputs.upload_url }}
          asset_path: ./docker-compose-ready.yml
          asset_name: docker-compose-ready.yml
          asset_content_type: application/yaml