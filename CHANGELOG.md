# 更新日志

## [v1.3.2] - 2025-09-22

### 🔧 功能优化
- **图片预览优化**: 修复图片预览窗口在非全屏模式下的显示问题，现在图片能充分利用预览窗口空间
- **聊天界面优化**: 移除文件消息的复制按钮功能，避免复制无意义的"发送了文件: xxx"内容
- **密码设置优化**: 修复刷新锁定设置的逻辑问题，密码未设置时不再要求密码验证

### 🐛 问题修复
- **预览窗口高度修复**: 修复图片预览窗口高度计算问题，确保非全屏模式也能充分利用空间
- **多窗口安全修复**: 修复同一浏览器不同窗口共享密码验证状态的安全问题，现在每个窗口独立验证
- **密码验证循环修复**: 修复密码验证成功后立即跳回验证页面的循环问题

## [v1.3.0] - 2025-09-22

### 🎉 新功能
- **密码保护系统**: 新增可选的访问密码保护功能，支持首次设置和密码验证
- **聊天文件发送**: 在聊天页面中支持直接发送文件和图片，与文件传输列表完全独立
- **文件预览功能**: 支持图片、视频、音频文件的在线预览，无需下载即可查看
- **版本检查系统**: 新增自动版本检查和更新提醒功能，支持GitHub Releases、GitHub Tags和Docker Hub多种版本源

### 🔧 功能优化
- **中文文件名支持**: 完美支持中文文件名显示和预览，解决文件名乱码问题
- **聊天界面增强**: 聊天消息支持文件卡片显示，包含文件图标、大小、类型等信息
- **预览窗口优化**: 重新设计预览窗口界面，更加简洁美观，支持全屏预览
- **文件管理优化**: 聊天文件和传输文件完全分离，避免混淆

### 🐛 问题修复
- **预览功能修复**: 修复了图片、视频、音频预览失败的问题
- **文件名显示修复**: 修复了中文文件名显示为扩展名的问题
- **密码验证修复**: 修复了密码设置和验证过程中的逻辑错误
- **中间件配置修复**: 修复了文件预览接口被密码验证中间件拦截的问题

### 🚀 技术改进
- **数据库结构优化**: 新增Message表的file_path字段，支持聊天文件独立存储
- **API接口完善**: 新增聊天文件预览和下载专用接口
- **前端组件重构**: 优化文件预览组件，提升用户体验
- **Docker配置优化**: 优化Docker构建流程，减少镜像大小

### 📦 部署改进
- **环境变量支持**: 支持通过环境变量配置GitHub仓库和Docker Hub仓库
- **多版本源支持**: 智能选择最佳版本检查源，提高更新检查成功率
- **错误处理增强**: 完善错误处理机制，提供更友好的错误提示

### 🔒 安全性提升
- **密码加密存储**: 使用bcrypt加密存储用户密码
- **访问控制**: 支持可选的密码保护，保护敏感文件
- **文件权限管理**: 完善文件访问权限控制

### 📱 用户体验
- **响应式设计**: 优化移动端显示效果
- **加载状态提示**: 增加文件上传和预览的加载状态提示
- **错误提示优化**: 提供更清晰友好的错误提示信息

### 🛠️ 开发者体验
- **代码结构优化**: 清理项目结构，移除测试文件和临时文件
- **文档完善**: 更新部署文档和使用说明
- **调试工具**: 保留必要的调试功能，便于问题排查

---

## [v1.2.0] - 2025-09-22

### 🎉 新功能
- **实时聊天系统**: 支持多用户实时聊天，消息即时同步
- **文件传输系统**: 支持各种文件类型的上传和下载
- **WebSocket通信**: 基于SocketIO的实时双向通信
- **多频道支持**: 支持创建不同的聊天频道

### 🔧 功能优化
- **用户界面**: 现代化的响应式设计，支持深色/浅色主题
- **文件管理**: 智能文件分类和过期时间管理
- **移动端适配**: 完美支持手机和平板设备

### 🐛 问题修复
- **连接稳定性**: 优化WebSocket连接稳定性
- **文件上传**: 修复大文件上传失败的问题
- **界面显示**: 修复移动端界面显示异常

---

## [v1.1.0] - 2025-09-21

### 🎉 新功能
- **基础文件共享**: 支持文件上传和下载
- **简单聊天**: 基础文本聊天功能
- **用户管理**: 简单的用户身份管理

### 🔧 功能优化
- **界面设计**: 简洁直观的用户界面
- **文件预览**: 基础文件预览功能

---

## [v1.0.0] - 2025-09-20

### 🎉 初始版本
- **项目启动**: LanShare项目正式发布
- **核心功能**: 基础的文件共享和聊天功能
- **Docker支持**: 完整的Docker化部署方案
